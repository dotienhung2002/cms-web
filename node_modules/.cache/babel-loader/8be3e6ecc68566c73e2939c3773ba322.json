{"ast":null,"code":"// @ts-nocheck\nimport axios from \"axios\";\nimport { toast } from \"react-toastify\";\nimport { FORMAT_ERROR } from \"../constants/status\";\nimport { HOST } from \"../constants/url\";\nimport { getQueryString } from \"./common\";\nfunction send(Request) {\n  var _Request$method = Request.method,\n    method = _Request$method === void 0 ? \"GET\" : _Request$method,\n    path = Request.path,\n    data = Request.data,\n    query = Request.query,\n    _Request$headers = Request.headers,\n    headers = _Request$headers === void 0 ? {} : _Request$headers,\n    newUrl = Request.newUrl;\n  return new Promise(function (resolve) {\n    var url = HOST + \"\".concat(path).concat(getQueryString(query));\n    if (newUrl) {\n      url = \"\".concat(newUrl).concat(getQueryString(query));\n    }\n    var token = window.localStorage.getItem(\"accessToken\");\n    if (token) {\n      var newToken = token.replace(/\"/g, \"\");\n      headers.Authorization = newToken;\n    }\n    axios({\n      method: method,\n      url: url,\n      data: data,\n      headers: headers\n    }).then(function (result) {\n      var data = result.data;\n      return resolve(data);\n    }).catch(function (error) {\n      var _error$response = error.response,\n        response = _error$response === void 0 ? {} : _error$response;\n      var result = response.data ? response.data : null;\n      if (!result) {\n        toast.warn(\"Somethig was wrong\");\n      } else {\n        var status = result.status,\n          _data = result.message;\n        console.log(result);\n        if (status === 500) {\n          toast.warn((FORMAT_ERROR === null || FORMAT_ERROR === void 0 ? void 0 : FORMAT_ERROR[result === null || result === void 0 ? void 0 : result.error]) || (result === null || result === void 0 ? void 0 : result.message));\n          return resolve(result);\n        } else if (status === 404 || status == 400) {\n          return resolve(result);\n        } else if (status === 505) {\n          toast.warn(\"Unauthorized\");\n        } else if (status === 401 && _data === \"Expired token received for JSON Web Token validation\") {\n          window.localStorage.clear();\n          window.location.href = \"/\";\n        } else if (status === 401 && _data === \"Unauthorized\" || status === 403 && _data === \"InvalidToken\") {\n          window.localStorage.clear();\n          window.location.href = \"/\";\n        } else if (status) {\n          toast.warn(_data || \"Lỗi server! Vui lòng bấm nút F12, mở tab network và chọn response rồi chụp lại gửi cho chúng tôi\");\n        } else {\n          return resolve(result.data);\n        }\n      }\n    });\n  });\n}\nexport default {\n  send: send\n};","map":{"version":3,"names":["axios","toast","FORMAT_ERROR","HOST","getQueryString","send","Request","method","path","data","query","headers","newUrl","Promise","resolve","url","token","window","localStorage","getItem","newToken","replace","Authorization","then","result","catch","error","response","warn","status","message","console","log","clear","location","href"],"sources":["/Users/abc/Downloads/Workspace/projectFPT/cms-fusamate/cms-fusamate/cms-fusamte/src/helper/request.js"],"sourcesContent":["// @ts-nocheck\nimport axios from \"axios\";\nimport { toast } from \"react-toastify\";\nimport { FORMAT_ERROR } from \"../constants/status\";\nimport { HOST } from \"../constants/url\";\n\nimport { getQueryString } from \"./common\";\nfunction send(Request) {\n  const { method = \"GET\", path, data, query, headers = {}, newUrl } = Request;\n  return new Promise((resolve) => {\n    let url = HOST+`${path}${getQueryString(query)}`;\n    if (newUrl) {\n      url = `${newUrl}${getQueryString(query)}`;\n    }\n    let token = window.localStorage.getItem(\"accessToken\");\n\n    if (token) {\n      const newToken = token.replace(/\"/g, \"\");\n      headers.Authorization = newToken;\n    }\n\n    axios({\n      method,\n      url,\n      data,\n      headers,\n    })\n      .then((result) => {\n        const data = result.data;\n        return resolve(data);\n      })\n      .catch((error) => {\n        const { response = {} } = error;\n\n        const result = response.data ? response.data : null;\n\n        if (!result) {\n          toast.warn(\"Somethig was wrong\");\n        } else {\n          const { status, message: data } = result;\n          console.log(result);\n          \n          if (status === 500) {\n            toast.warn(FORMAT_ERROR?.[result?.error] || result?.message);\n            return resolve(result);\n          } else if (status === 404||status==400) {\n            return resolve(result);\n          } else if (status === 505) {\n            toast.warn(\"Unauthorized\");\n          } else if (\n            status === 401 &&\n            data === \"Expired token received for JSON Web Token validation\"\n          ) {\n            window.localStorage.clear();\n            window.location.href = \"/\";\n          } else if (\n            (status === 401 && data === \"Unauthorized\") ||\n            (status === 403 && data === \"InvalidToken\")\n          ) {\n            window.localStorage.clear();\n            window.location.href = \"/\";\n          } else if (status) {\n            toast.warn(\n              data ||\n                \"Lỗi server! Vui lòng bấm nút F12, mở tab network và chọn response rồi chụp lại gửi cho chúng tôi\"\n            );\n          } else {\n            return resolve(result.data);\n          }\n        }\n      });\n  });\n}\n\nexport default {\n  send,\n};\n"],"mappings":"AAAA;AACA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,KAAK,QAAQ,gBAAgB;AACtC,SAASC,YAAY,QAAQ,qBAAqB;AAClD,SAASC,IAAI,QAAQ,kBAAkB;AAEvC,SAASC,cAAc,QAAQ,UAAU;AACzC,SAASC,IAAI,CAACC,OAAO,EAAE;EACrB,sBAAoEA,OAAO,CAAnEC,MAAM;IAANA,MAAM,gCAAG,KAAK;IAAEC,IAAI,GAAwCF,OAAO,CAAnDE,IAAI;IAAEC,IAAI,GAAkCH,OAAO,CAA7CG,IAAI;IAAEC,KAAK,GAA2BJ,OAAO,CAAvCI,KAAK;IAAA,mBAA2BJ,OAAO,CAAhCK,OAAO;IAAPA,OAAO,iCAAG,CAAC,CAAC;IAAEC,MAAM,GAAKN,OAAO,CAAlBM,MAAM;EAC/D,OAAO,IAAIC,OAAO,CAAC,UAACC,OAAO,EAAK;IAC9B,IAAIC,GAAG,GAAGZ,IAAI,aAAIK,IAAI,SAAGJ,cAAc,CAACM,KAAK,CAAC,CAAE;IAChD,IAAIE,MAAM,EAAE;MACVG,GAAG,aAAMH,MAAM,SAAGR,cAAc,CAACM,KAAK,CAAC,CAAE;IAC3C;IACA,IAAIM,KAAK,GAAGC,MAAM,CAACC,YAAY,CAACC,OAAO,CAAC,aAAa,CAAC;IAEtD,IAAIH,KAAK,EAAE;MACT,IAAMI,QAAQ,GAAGJ,KAAK,CAACK,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC;MACxCV,OAAO,CAACW,aAAa,GAAGF,QAAQ;IAClC;IAEApB,KAAK,CAAC;MACJO,MAAM,EAANA,MAAM;MACNQ,GAAG,EAAHA,GAAG;MACHN,IAAI,EAAJA,IAAI;MACJE,OAAO,EAAPA;IACF,CAAC,CAAC,CACCY,IAAI,CAAC,UAACC,MAAM,EAAK;MAChB,IAAMf,IAAI,GAAGe,MAAM,CAACf,IAAI;MACxB,OAAOK,OAAO,CAACL,IAAI,CAAC;IACtB,CAAC,CAAC,CACDgB,KAAK,CAAC,UAACC,KAAK,EAAK;MAChB,sBAA0BA,KAAK,CAAvBC,QAAQ;QAARA,QAAQ,gCAAG,CAAC,CAAC;MAErB,IAAMH,MAAM,GAAGG,QAAQ,CAAClB,IAAI,GAAGkB,QAAQ,CAAClB,IAAI,GAAG,IAAI;MAEnD,IAAI,CAACe,MAAM,EAAE;QACXvB,KAAK,CAAC2B,IAAI,CAAC,oBAAoB,CAAC;MAClC,CAAC,MAAM;QACL,IAAQC,MAAM,GAAoBL,MAAM,CAAhCK,MAAM;UAAWpB,KAAI,GAAKe,MAAM,CAAxBM,OAAO;QACvBC,OAAO,CAACC,GAAG,CAACR,MAAM,CAAC;QAEnB,IAAIK,MAAM,KAAK,GAAG,EAAE;UAClB5B,KAAK,CAAC2B,IAAI,CAAC,CAAA1B,YAAY,aAAZA,YAAY,uBAAZA,YAAY,CAAGsB,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAEE,KAAK,CAAC,MAAIF,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAEM,OAAO,EAAC;UAC5D,OAAOhB,OAAO,CAACU,MAAM,CAAC;QACxB,CAAC,MAAM,IAAIK,MAAM,KAAK,GAAG,IAAEA,MAAM,IAAE,GAAG,EAAE;UACtC,OAAOf,OAAO,CAACU,MAAM,CAAC;QACxB,CAAC,MAAM,IAAIK,MAAM,KAAK,GAAG,EAAE;UACzB5B,KAAK,CAAC2B,IAAI,CAAC,cAAc,CAAC;QAC5B,CAAC,MAAM,IACLC,MAAM,KAAK,GAAG,IACdpB,KAAI,KAAK,sDAAsD,EAC/D;UACAQ,MAAM,CAACC,YAAY,CAACe,KAAK,EAAE;UAC3BhB,MAAM,CAACiB,QAAQ,CAACC,IAAI,GAAG,GAAG;QAC5B,CAAC,MAAM,IACJN,MAAM,KAAK,GAAG,IAAIpB,KAAI,KAAK,cAAc,IACzCoB,MAAM,KAAK,GAAG,IAAIpB,KAAI,KAAK,cAAe,EAC3C;UACAQ,MAAM,CAACC,YAAY,CAACe,KAAK,EAAE;UAC3BhB,MAAM,CAACiB,QAAQ,CAACC,IAAI,GAAG,GAAG;QAC5B,CAAC,MAAM,IAAIN,MAAM,EAAE;UACjB5B,KAAK,CAAC2B,IAAI,CACRnB,KAAI,IACF,kGAAkG,CACrG;QACH,CAAC,MAAM;UACL,OAAOK,OAAO,CAACU,MAAM,CAACf,IAAI,CAAC;QAC7B;MACF;IACF,CAAC,CAAC;EACN,CAAC,CAAC;AACJ;AAEA,eAAe;EACbJ,IAAI,EAAJA;AACF,CAAC"},"metadata":{},"sourceType":"module"}