{"ast":null,"code":"// @ts-nocheck\nimport axios from \"axios\";\nimport { toast } from \"react-toastify\";\nimport { FORMAT_ERROR } from \"../constants/status\";\nimport { HOST } from \"../constants/url\";\nimport { getQueryString } from \"./common\";\n\nfunction send(Request) {\n  var _Request$method = Request.method,\n      method = _Request$method === void 0 ? \"GET\" : _Request$method,\n      path = Request.path,\n      data = Request.data,\n      query = Request.query,\n      _Request$headers = Request.headers,\n      headers = _Request$headers === void 0 ? {} : _Request$headers,\n      newUrl = Request.newUrl;\n  return new Promise(function (resolve) {\n    var url = HOST + \"\".concat(path).concat(getQueryString(query));\n\n    if (newUrl) {\n      url = \"\".concat(newUrl).concat(getQueryString(query));\n    }\n\n    var token = window.localStorage.getItem(\"accessToken\");\n\n    if (token) {\n      var newToken = token.replace(/\"/g, \"\");\n      headers.Authorization = newToken;\n    }\n\n    axios({\n      method: method,\n      url: url,\n      data: data,\n      headers: headers\n    }).then(function (result) {\n      var data = result.data;\n      return resolve(data);\n    }).catch(function (error) {\n      var _error$response = error.response,\n          response = _error$response === void 0 ? {} : _error$response;\n      var result = response.data ? response.data : null;\n\n      if (!result) {\n        toast.warn(\"Somethig was wrong\");\n      } else {\n        var status = result.status,\n            _data = result.message;\n        console.log(result);\n\n        if (status === 500) {\n          toast.warn((FORMAT_ERROR === null || FORMAT_ERROR === void 0 ? void 0 : FORMAT_ERROR[result === null || result === void 0 ? void 0 : result.error]) || (result === null || result === void 0 ? void 0 : result.message));\n          return resolve(result);\n        } else if (status === 404 || status == 400) {\n          return resolve(result);\n        } else if (status === 505) {\n          toast.warn(\"Unauthorized\");\n        } else if (status === 401 && _data === \"Expired token received for JSON Web Token validation\") {\n          window.localStorage.clear();\n          window.location.href = \"/\";\n        } else if (status === 401 && _data === \"Unauthorized\" || status === 403 && _data === \"InvalidToken\") {\n          window.localStorage.clear();\n          window.location.href = \"/\";\n        } else if (status) {\n          toast.warn(_data || \"Lỗi server! Vui lòng bấm nút F12, mở tab network và chọn response rồi chụp lại gửi cho chúng tôi\");\n        } else {\n          return resolve(result.data);\n        }\n      }\n    });\n  });\n}\n\nexport default {\n  send: send\n};","map":{"version":3,"sources":["/Users/abc/Downloads/Workspace/projectFPT/cms-fusamate/cms-fusamate/cms-fusamte/src/helper/request.js"],"names":["axios","toast","FORMAT_ERROR","HOST","getQueryString","send","Request","method","path","data","query","headers","newUrl","Promise","resolve","url","token","window","localStorage","getItem","newToken","replace","Authorization","then","result","catch","error","response","warn","status","message","console","log","clear","location","href"],"mappings":"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","sourcesContent":["// @ts-nocheck\nimport axios from \"axios\";\nimport { toast } from \"react-toastify\";\nimport { FORMAT_ERROR } from \"../constants/status\";\nimport { HOST } from \"../constants/url\";\n\nimport { getQueryString } from \"./common\";\nfunction send(Request) {\n  const { method = \"GET\", path, data, query, headers = {}, newUrl } = Request;\n  return new Promise((resolve) => {\n    let url = HOST+`${path}${getQueryString(query)}`;\n    if (newUrl) {\n      url = `${newUrl}${getQueryString(query)}`;\n    }\n    let token = window.localStorage.getItem(\"accessToken\");\n\n    if (token) {\n      const newToken = token.replace(/\"/g, \"\");\n      headers.Authorization = newToken;\n    }\n\n    axios({\n      method,\n      url,\n      data,\n      headers,\n    })\n      .then((result) => {\n        const data = result.data;\n        return resolve(data);\n      })\n      .catch((error) => {\n        const { response = {} } = error;\n\n        const result = response.data ? response.data : null;\n\n        if (!result) {\n          toast.warn(\"Somethig was wrong\");\n        } else {\n          const { status, message: data } = result;\n          console.log(result);\n          \n          if (status === 500) {\n            toast.warn(FORMAT_ERROR?.[result?.error] || result?.message);\n            return resolve(result);\n          } else if (status === 404||status==400) {\n            return resolve(result);\n          } else if (status === 505) {\n            toast.warn(\"Unauthorized\");\n          } else if (\n            status === 401 &&\n            data === \"Expired token received for JSON Web Token validation\"\n          ) {\n            window.localStorage.clear();\n            window.location.href = \"/\";\n          } else if (\n            (status === 401 && data === \"Unauthorized\") ||\n            (status === 403 && data === \"InvalidToken\")\n          ) {\n            window.localStorage.clear();\n            window.location.href = \"/\";\n          } else if (status) {\n            toast.warn(\n              data ||\n                \"Lỗi server! Vui lòng bấm nút F12, mở tab network và chọn response rồi chụp lại gửi cho chúng tôi\"\n            );\n          } else {\n            return resolve(result.data);\n          }\n        }\n      });\n  });\n}\n\nexport default {\n  send,\n};\n"]},"metadata":{},"sourceType":"module"}