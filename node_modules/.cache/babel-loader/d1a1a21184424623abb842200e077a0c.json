{"ast":null,"code":"// @ts-nocheck\nimport axios from\"axios\";import{toast}from\"react-toastify\";import{FORMAT_ERROR}from\"../constants/status\";import{HOST}from\"../constants/url\";import{getQueryString}from\"./common\";function send(Request){var _Request$method=Request.method,method=_Request$method===void 0?\"GET\":_Request$method,path=Request.path,data=Request.data,query=Request.query,_Request$headers=Request.headers,headers=_Request$headers===void 0?{}:_Request$headers,newUrl=Request.newUrl;return new Promise(function(resolve){var url=HOST+\"\".concat(path).concat(getQueryString(query));if(newUrl){url=\"\".concat(newUrl).concat(getQueryString(query));}var token=window.localStorage.getItem(\"accessToken\");if(token){var newToken=token.replace(/\"/g,\"\");headers.Authorization=newToken;}axios({method:method,url:url,data:data,headers:headers}).then(function(result){var data=result.data;return resolve(data);}).catch(function(error){var _error$response=error.response,response=_error$response===void 0?{}:_error$response;var result=response.data?response.data:null;if(!result){toast.warn(\"Somethig was wrong\");}else{var status=result.status,_data=result.message;console.log(result);if(status===500){toast.warn((FORMAT_ERROR===null||FORMAT_ERROR===void 0?void 0:FORMAT_ERROR[result===null||result===void 0?void 0:result.error])||(result===null||result===void 0?void 0:result.message));return resolve(result);}else if(status===404||status==400){toast.error(result===null||result===void 0?void 0:result.error);return resolve(result);}else if(status===505){toast.warn(\"Unauthorized\");}else if(status===401&&_data===\"Expired token received for JSON Web Token validation\"){window.localStorage.clear();window.location.href=\"/\";}else if(status===401&&_data===\"Unauthorized\"||status===403&&_data===\"InvalidToken\"){window.localStorage.clear();window.location.href=\"/\";}else if(status){toast.warn(_data||\"Lỗi server! Vui lòng bấm nút F12, mở tab network và chọn response rồi chụp lại gửi cho chúng tôi\");}else{return resolve(result.data);}}});});}export default{send:send};","map":{"version":3,"names":["axios","toast","FORMAT_ERROR","HOST","getQueryString","send","Request","method","path","data","query","headers","newUrl","Promise","resolve","url","token","window","localStorage","getItem","newToken","replace","Authorization","then","result","catch","error","response","warn","status","message","console","log","clear","location","href"],"sources":["/Users/abc/Downloads/Workspace/projectFPT/cms-fusamate/cms-fusamate/cms-fusamte/src/helper/request.js"],"sourcesContent":["// @ts-nocheck\nimport axios from \"axios\";\nimport { toast } from \"react-toastify\";\nimport { FORMAT_ERROR } from \"../constants/status\";\nimport { HOST } from \"../constants/url\";\n\nimport { getQueryString } from \"./common\";\nfunction send(Request) {\n  const { method = \"GET\", path, data, query, headers = {}, newUrl } = Request;\n  return new Promise((resolve) => {\n    let url = HOST+`${path}${getQueryString(query)}`;\n    if (newUrl) {\n      url = `${newUrl}${getQueryString(query)}`;\n    }\n    let token = window.localStorage.getItem(\"accessToken\");\n\n    if (token) {\n      const newToken = token.replace(/\"/g, \"\");\n      headers.Authorization = newToken;\n    }\n\n    axios({\n      method,\n      url,\n      data,\n      headers,\n    })\n      .then((result) => {\n        const data = result.data;\n        return resolve(data);\n      })\n      .catch((error) => {\n        const { response = {} } = error;\n\n        const result = response.data ? response.data : null;\n\n        if (!result) {\n          toast.warn(\"Somethig was wrong\");\n        } else {\n          const { status, message: data } = result;\n          console.log(result);\n          \n          if (status === 500) {\n            toast.warn(FORMAT_ERROR?.[result?.error] || result?.message);\n            return resolve(result);\n          } else if (status === 404||status==400) {\n            toast.error(result?.error)\n            return resolve(result);\n          } else if (status === 505) {\n            toast.warn(\"Unauthorized\");\n          } else if (\n            status === 401 &&\n            data === \"Expired token received for JSON Web Token validation\"\n          ) {\n            window.localStorage.clear();\n            window.location.href = \"/\";\n          } else if (\n            (status === 401 && data === \"Unauthorized\") ||\n            (status === 403 && data === \"InvalidToken\")\n          ) {\n            window.localStorage.clear();\n            window.location.href = \"/\";\n          } else if (status) {\n            toast.warn(\n              data ||\n                \"Lỗi server! Vui lòng bấm nút F12, mở tab network và chọn response rồi chụp lại gửi cho chúng tôi\"\n            );\n          } else {\n            return resolve(result.data);\n          }\n        }\n      });\n  });\n}\n\nexport default {\n  send,\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}